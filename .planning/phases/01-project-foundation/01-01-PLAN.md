---
phase: 01-project-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - pubspec.yaml
  - analysis_options.yaml
  - lib/main.dart
  - lib/app/app.dart
  - lib/app/router.dart
  - lib/features/home/presentation/home_screen.dart
  - lib/features/settings/presentation/settings_screen.dart
  - .env.example
  - .gitignore
autonomous: true

must_haves:
  truths:
    - "App compiles and runs with flutter run"
    - "Navigation between home and settings screens works"
    - "Riverpod ProviderScope wraps the app"
    - "GoRouter handles routing declaratively"
    - "Code generation runs without errors"
    - "flutter analyze passes with no errors"
  artifacts:
    - path: "lib/main.dart"
      provides: "App entry point with ProviderScope"
      contains: "ProviderScope"
    - path: "lib/app/router.dart"
      provides: "GoRouter configuration"
      contains: "GoRouter"
    - path: "lib/app/app.dart"
      provides: "Root App widget using MaterialApp.router"
      contains: "MaterialApp.router"
    - path: "lib/features/home/presentation/home_screen.dart"
      provides: "Home placeholder screen with navigation to settings"
    - path: "lib/features/settings/presentation/settings_screen.dart"
      provides: "Settings placeholder screen with back navigation"
    - path: "analysis_options.yaml"
      provides: "Linting with very_good_analysis"
      contains: "very_good_analysis"
  key_links:
    - from: "lib/main.dart"
      to: "lib/app/app.dart"
      via: "runApp(ProviderScope(child: App()))"
    - from: "lib/app/app.dart"
      to: "lib/app/router.dart"
      via: "ref.watch(routerProvider)"
    - from: "lib/app/router.dart"
      to: "lib/features/*/presentation/*_screen.dart"
      via: "GoRoute builder references"
---

<objective>
Create the Flutter project with all dependencies, architecture scaffolding, linting, and placeholder screens with working navigation.

Purpose: Establish the project foundation that all future phases build on — correct dependencies, code generation pipeline, and navigation structure.
Output: A compilable Flutter project with Riverpod, GoRouter, freezed, and two navigable placeholder screens.
</objective>

<execution_context>
@/Users/tijmen/.claude/get-shit-done/workflows/execute-plan.md
@/Users/tijmen/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-project-foundation/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Flutter project with dependencies and linting</name>
  <files>
    pubspec.yaml
    analysis_options.yaml
    .gitignore
  </files>
  <action>
    1. Run `flutter create running_playlist_ai --org com.runningplaylist` in the project root's parent directory, then move contents to project root (or create in-place if the directory is empty enough).
       - If the project root already has .planning/, create the Flutter project in a temp dir and move Flutter files into project root without overwriting .planning/

    2. Add core dependencies:
       `flutter pub add flutter_riverpod riverpod_annotation go_router supabase_flutter freezed_annotation json_annotation flutter_dotenv`

    3. Add dev dependencies:
       `flutter pub add dev:very_good_analysis dev:freezed dev:json_serializable dev:build_runner dev:riverpod_generator dev:riverpod_lint`

    4. Remove default `flutter_lints` from pubspec.yaml if present.

    5. Replace analysis_options.yaml content with:
       ```yaml
       include: package:very_good_analysis/analysis_options.yaml

       analyzer:
         errors:
           invalid_annotation_target: ignore
         exclude:
           - "**/*.g.dart"
           - "**/*.freezed.dart"

       linter:
         rules:
           public_member_api_docs: false
       ```

    6. Create `.env.example` with:
       ```
       SUPABASE_URL=your-supabase-url-here
       SUPABASE_ANON_KEY=your-supabase-anon-key-here
       ```

    7. Ensure `.gitignore` includes `.env` (but not `.env.example`).

    8. Run `flutter pub get` to verify all dependencies resolve.
  </action>
  <verify>
    - `flutter pub get` succeeds with no errors
    - `flutter analyze` passes with no errors (warnings acceptable for now)
    - `.env.example` exists with placeholder Supabase credentials
  </verify>
  <done>
    Flutter project exists with all required dependencies installed, very_good_analysis linting configured, and .env template ready.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create app architecture with navigation and placeholder screens</name>
  <files>
    lib/main.dart
    lib/app/app.dart
    lib/app/router.dart
    lib/features/home/presentation/home_screen.dart
    lib/features/settings/presentation/settings_screen.dart
  </files>
  <action>
    1. Create `lib/app/router.dart`:
       - Use `@riverpod` annotation to create a `router` provider
       - Define routes: `/` -> HomeScreen, `/settings` -> SettingsScreen
       - Include `part 'router.g.dart';` for code generation
       - Import the screen files

    2. Create `lib/app/app.dart`:
       - ConsumerWidget that builds MaterialApp.router
       - Use `ref.watch(routerProvider)` for routerConfig
       - Set title to 'Running Playlist AI'

    3. Create `lib/features/home/presentation/home_screen.dart`:
       - Simple Scaffold with AppBar title "Running Playlist AI"
       - Body with centered text "Home Screen" and a button/ListTile to navigate to /settings
       - Use `context.go('/settings')` or `context.push('/settings')` for navigation

    4. Create `lib/features/settings/presentation/settings_screen.dart`:
       - Scaffold with AppBar title "Settings" and back button
       - Body with centered text "Settings Screen"

    5. Create `lib/main.dart`:
       - Import flutter_riverpod
       - WidgetsFlutterBinding.ensureInitialized()
       - Wrap App() in ProviderScope
       - Do NOT initialize Supabase yet (that's plan 02)
       - Do NOT load .env yet (that's plan 02)

    6. Run `dart run build_runner build --delete-conflicting-outputs` to generate .g.dart files for the router.

    7. Run `flutter analyze` to check for lint errors and fix any issues.
  </action>
  <verify>
    - `dart run build_runner build --delete-conflicting-outputs` completes without errors
    - `flutter analyze` passes
    - `flutter build web` succeeds (quick compilation check)
  </verify>
  <done>
    App has working navigation between Home and Settings screens. Main entry point uses ProviderScope. GoRouter configured via Riverpod provider with code generation. All generated files (.g.dart) exist and are valid.
  </done>
</task>

</tasks>

<verification>
1. `flutter pub get` — dependencies resolve
2. `dart run build_runner build --delete-conflicting-outputs` — code generation succeeds
3. `flutter analyze` — no errors
4. `flutter build web` — compiles successfully
</verification>

<success_criteria>
- Flutter project with all Phase 1 dependencies installed
- very_good_analysis linting active and passing
- Two placeholder screens (Home, Settings) with GoRouter navigation
- Riverpod ProviderScope wrapping the app
- Code generation pipeline working (router.g.dart exists)
- Project compiles for web target
</success_criteria>

<output>
After completion, create `.planning/phases/01-project-foundation/01-01-SUMMARY.md`
</output>
