---
phase: 08-structured-run-types
task: 0
total_tasks: 3
status: planned
last_updated: 2026-02-05
---

<current_state>
Phase 8 is fully planned, researched, and verified. Ready for execution. No tasks have started yet.

Phase 6 (Steady Run Planning) was completed and verified earlier this session. Phase 8 was planned as the next actionable phase since Phases 2-4 and 7 are blocked on Spotify Developer Dashboard.
</current_state>

<completed_work>

- Phase 6 completed: both plans (06-01 domain TDD, 06-02 UI) executed and verified
- Phase 8 research: 08-RESEARCH.md written (domain logic, UI patterns, BPM fractions, pitfalls)
- Phase 8 planning: 08-01-PLAN.md (TDD) and 08-02-PLAN.md (UI) created
- Phase 8 plan verification: checker passed all dimensions
- ROADMAP.md updated with Phase 8 plan entries
- STATE.md updated to reflect Phase 6 completion
</completed_work>

<remaining_work>

- Execute Phase 8 Wave 1: 08-01-PLAN.md (TDD -- createWarmUpCoolDownPlan + createIntervalPlan factory methods)
- Execute Phase 8 Wave 2: 08-02-PLAN.md (UI -- run type selector, config forms, segment timeline, save logic)
- Human checkpoint in 08-02 for visual verification of all three run types
- Phase 8 verification after both plans complete
- Update STATE.md and ROADMAP.md to mark Phase 8 complete
</remaining_work>

<decisions_made>

- Phase 8 executed before Phase 7 because domain + UI can be built without playlist generation (only success criterion #3 needs Phase 7)
- Data layer (run_plan.dart, run_plan_preferences.dart, run_plan_providers.dart) needs ZERO changes -- already supports multi-segment plans
- BPM fractions: warm-up/cool-down at 85% of target, rest intervals at 80% of target
- Defaults: 5-min warm-up/cool-down, 4 intervals x 2-min work / 1-min rest
- Main segment clamped to minimum 60s when warm-up+cool-down exceed total duration
- SegmentedButton for run type selection (Material 3 standard)
- Auth guard remains disabled (return null in router.dart) while Spotify Dashboard blocked
</decisions_made>

<blockers>
- Spotify Developer Dashboard still not accepting new app integrations (blocks Phases 2, 3, 4, 7)
- Success criterion #3 for Phase 8 ("playlist transitions between BPM targets") deferred until Phase 7 exists
</blockers>

<context>
The project follows a GSD (Get Shit Done) workflow with research -> plan -> execute -> verify cycles. Model profile is "quality" (opus for executor/planner, sonnet for verifier/checker).

Key patterns: TDD for domain logic (RED/GREEN/REFACTOR), ConsumerStatefulWidget for screens, manual Riverpod providers, SharedPreferences JSON persistence.

The RunPlan model was designed from the start to support multiple segments -- Phase 8 is the payoff of that forward-looking design from Phase 6.

The user tested the run plan screen manually this session (hot restart needed after auth bypass edit). All Phase 6 features verified working.
</context>

<next_action>
Run `/gsd:execute-phase 8` to execute both plans. Wave 1 (08-01 TDD) runs first, then Wave 2 (08-02 UI) which has a human checkpoint.
</next_action>
