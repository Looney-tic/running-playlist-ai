---
phase: 11-auth-cleanup
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - lib/app/router.dart
  - lib/features/home/presentation/home_screen.dart
autonomous: true

must_haves:
  truths:
    - "App launches directly to home screen without any login prompt or Spotify UI"
    - "Home screen shows navigation to stride calculator, run planner, taste profile, and playlist generation"
    - "All v0.1 features (stride calculator, run planner) remain accessible from home hub"
    - "No logout button or auth-related UI is visible on the home screen"
    - "Tapping a placeholder feature button shows a 'Coming soon' message rather than crashing"
  artifacts:
    - path: "lib/app/router.dart"
      provides: "Simplified router without auth notifier, with placeholder routes"
      contains: "GoRoute.*taste-profile|GoRoute.*playlist"
    - path: "lib/features/home/presentation/home_screen.dart"
      provides: "Home hub with navigation to all features"
      contains: "Taste Profile|Generate Playlist"
  key_links:
    - from: "lib/app/router.dart"
      to: "lib/features/home/presentation/home_screen.dart"
      via: "GoRoute path '/' builder HomeScreen"
      pattern: "path:\\s*'/'"
    - from: "lib/features/home/presentation/home_screen.dart"
      to: "lib/app/router.dart"
      via: "context.push for each feature route"
      pattern: "context\\.push\\('/taste-profile'\\)"
---

<objective>
Remove Spotify auth machinery from the router, strip auth UI from the home screen, and build a home hub with navigation buttons for all v1.0 features (including placeholder routes for features not yet built).

Purpose: Unblock the v1.0 milestone by removing the Spotify login gate so users land directly on a functional home hub. This is the entry point for all subsequent phases.
Output: Clean router without auth refresh logic, home screen with 5 feature buttons (stride, run plan, taste profile, generate playlist, playlist history), and placeholder "Coming soon" screens for unbuilt features.
</objective>

<execution_context>
@/Users/tijmen/.claude/get-shit-done/workflows/execute-plan.md
@/Users/tijmen/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@lib/app/router.dart
@lib/features/home/presentation/home_screen.dart
</context>

<tasks>

<task type="auto">
  <name>Task 1: Simplify router — remove auth notifier, login route, add placeholder routes</name>
  <files>lib/app/router.dart</files>
  <action>
Rewrite `lib/app/router.dart` with these specific changes:

1. **Remove imports:** Delete `dart:async`, `supabase_flutter` import, and `login_screen.dart` import
2. **Remove AuthNotifier class entirely** (lines 18-37) — the class, the StreamSubscription, isAuthenticated getter, dispose override
3. **Remove authNotifierProvider entirely** (lines 42-46)
4. **Simplify routerProvider:** Remove `ref.watch(authNotifierProvider)`, remove `refreshListenable: authNotifier`, remove `redirect` callback. The GoRouter should be a plain router with just `initialLocation` and `routes`
5. **Remove the `/login` GoRoute** — keep the LoginScreen file dormant in `lib/features/auth/`
6. **Add placeholder routes** for features not yet built. Create a simple `_ComingSoonScreen` widget (a private StatelessWidget in the same file) that shows centered text "Coming soon" with an AppBar containing a back button. Add these routes:
   - `/taste-profile` -> `_ComingSoonScreen(title: 'Taste Profile')`
   - `/playlist` -> `_ComingSoonScreen(title: 'Generate Playlist')`
   - `/playlist-history` -> `_ComingSoonScreen(title: 'Playlist History')`

Keep existing routes: `/` (HomeScreen), `/settings` (SettingsScreen), `/stride` (StrideScreen), `/run-plan` (RunPlanScreen).

The `_ComingSoonScreen` is a simple `StatelessWidget` (NOT a ConsumerWidget — it has no providers):
```dart
class _ComingSoonScreen extends StatelessWidget {
  const _ComingSoonScreen({required this.title});
  final String title;

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: Text(title)),
      body: const Center(
        child: Text('Coming soon', style: TextStyle(fontSize: 18)),
      ),
    );
  }
}
```

Do NOT import `package:flutter/material.dart` — it is already imported via `go_router.dart` re-exports... Actually, you DO need to import `package:flutter/material.dart` since the file uses `ChangeNotifier` etc. which come from Flutter. After cleanup, you still need `material.dart` for `StatelessWidget`, `Scaffold`, `AppBar`, `Text`, `Center`, `TextStyle`.

Final import list should be:
```dart
import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import 'package:go_router/go_router.dart';
import 'package:running_playlist_ai/features/home/presentation/home_screen.dart';
import 'package:running_playlist_ai/features/run_plan/presentation/run_plan_screen.dart';
import 'package:running_playlist_ai/features/settings/presentation/settings_screen.dart';
import 'package:running_playlist_ai/features/stride/presentation/stride_screen.dart';
```
  </action>
  <verify>
Run `dart analyze lib/app/router.dart` — zero errors, zero warnings.
Grep: no reference to `AuthNotifier`, `authNotifierProvider`, `refreshListenable`, `LoginScreen`, or `supabase_flutter` in the file.
Confirm routes exist: `/`, `/settings`, `/stride`, `/run-plan`, `/taste-profile`, `/playlist`, `/playlist-history`.
  </verify>
  <done>
router.dart contains a plain GoRouter with no auth logic, no login route, and three placeholder "Coming soon" routes for taste-profile, playlist, and playlist-history. File compiles cleanly with `dart analyze`.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update home screen — remove auth, add feature navigation buttons</name>
  <files>lib/features/home/presentation/home_screen.dart</files>
  <action>
Modify `lib/features/home/presentation/home_screen.dart` with these specific changes:

1. **Remove the auth import:** Delete `import 'package:running_playlist_ai/features/auth/providers/auth_providers.dart';`
2. **Update the doc comment:** Change from "Home screen displayed to authenticated users" to "Home hub screen with navigation to all app features."
3. **Remove "After logout" doc comment line** as well.
4. **Replace the body content.** Remove the entire logout `ElevatedButton` (the one with `ref.read(authRepositoryProvider).signOut()`). Add three new `ElevatedButton.icon` buttons following the established pattern:

   After the existing "Plan Run" button + SizedBox(height: 16), add:

   ```dart
   ElevatedButton.icon(
     onPressed: () => context.push('/taste-profile'),
     icon: const Icon(Icons.music_note),
     label: const Text('Taste Profile'),
   ),
   const SizedBox(height: 16),
   ElevatedButton.icon(
     onPressed: () => context.push('/playlist'),
     icon: const Icon(Icons.queue_music),
     label: const Text('Generate Playlist'),
   ),
   const SizedBox(height: 16),
   ElevatedButton.icon(
     onPressed: () => context.push('/playlist-history'),
     icon: const Icon(Icons.history),
     label: const Text('Playlist History'),
   ),
   ```

5. **Keep the widget as ConsumerWidget** — even though we removed the auth ref.read, it may use ref in the future for taste profile state. ConsumerWidget with no ref usage is harmless and avoids a future change. However, if you prefer consistency, you MAY change it to StatelessWidget and change `build(BuildContext context, WidgetRef ref)` to `build(BuildContext context)`. Either approach is acceptable — choose ConsumerWidget to minimize diff.

6. **Update the "Home Screen" text** to something more descriptive. Change `const Text('Home Screen')` to `const Text('Running Playlist AI', style: TextStyle(fontSize: 20, fontWeight: FontWeight.bold))`. Wait — the AppBar already has "Running Playlist AI" as its title. Instead, change it to a more welcoming message: `const Text('What would you like to do?', style: TextStyle(fontSize: 18))`.
  </action>
  <verify>
Run `dart analyze lib/features/home/presentation/home_screen.dart` — zero errors, zero warnings.
Grep: no reference to `authRepositoryProvider`, `auth_providers`, or `signOut` in the file.
Confirm 5 ElevatedButton.icon widgets exist: Stride Calculator, Plan Run, Taste Profile, Generate Playlist, Playlist History.
  </verify>
  <done>
Home screen has no auth references, displays 5 navigation buttons (stride, run plan, taste profile, generate playlist, playlist history), and compiles cleanly with `dart analyze`. The logout button is gone.
  </done>
</task>

</tasks>

<verification>
After both tasks complete, run full project analysis and compilation:

1. `dart analyze lib/` — zero errors across the entire project (not just modified files)
2. `flutter build apk --debug 2>&1 | tail -20` — or at minimum `dart analyze` on the full lib/ to catch cross-file import issues
3. Verify no file in `lib/` imports `AuthNotifier` or `authNotifierProvider` from router.dart (they may import from auth_providers.dart which is fine — those are dormant)
4. Verify `lib/features/auth/` directory still exists and is untouched (dormant)
5. Verify `lib/core/constants/spotify_constants.dart` still exists and is untouched (dormant)
6. Verify `lib/main.dart` still has `Supabase.initialize()` (kept for future use)
</verification>

<success_criteria>
- `dart analyze lib/` reports zero errors and zero warnings on modified files
- App router has no auth-related code (no AuthNotifier, no authNotifierProvider, no refreshListenable, no redirect logic, no /login route)
- Home screen has exactly 5 feature navigation buttons with correct routes
- Three placeholder routes (/taste-profile, /playlist, /playlist-history) show "Coming soon" screens
- All files in lib/features/auth/ and lib/core/constants/ are completely untouched
- Requirements AUTH-10 and AUTH-11 are satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/11-auth-cleanup/11-01-SUMMARY.md`
</output>
